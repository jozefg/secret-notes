\newcommand{\defeq}{\triangleq}
\newcommand{\MTT}{\textsf{MTT}}
\newcommand{\MLTT}{\textsf{MLTT}}
\newcommand{\MLTTLock}{\textsf{MLTT}\textsubscript{$\Lock$}}

\NewDocumentCommand{\CxLen}{m}{\verts{#1}}

\NewDocumentCommand{\DeclVar}{mmD<>{\mu}}{#1 : (#3 \mid #2)}
\NewDocumentCommand{\DeclNameless}{mD<>{\mu}}{#2 \mid #1}

\NewDocumentCommand{\Prod}{mm}{\textstyle \sum(#1, #2)}
\NewDocumentCommand{\Fn}{mmD<>{\mu}}{(\DeclNameless{#1}<#3>) \to #2}
\NewDocumentCommand{\FnV}{mmmD<>{\mu}}{(\DeclVar{#1}{#2}<#4>) \to #3}
\NewDocumentCommand{\Modify}{O{\mu}G{-}}{\gls{#1 \mid #2}}

\NewDocumentCommand{\Lock}{}{\text{\faLock}}
\NewDocumentCommand{\Unlock}{}{\text{\faUnlock}}

\NewDocumentCommand{\Var}{G{k}}{\mathbf{v}_{#1}}
\NewDocumentCommand{\Pair}{mm}{\parens{#1, #2}}
\NewDocumentCommand{\Proj}{O{i}g}{\mathsf{pr}_{#1}\IfValueT{#2}{\parens{#2}}}
\NewDocumentCommand{\App}{smm}{\IfBooleanTF{#1}{\parens{#2}}{#2}\parens{#3}}
\NewDocumentCommand{\Lam}{om}{\IfValueTF{#1}{\lambda #1.\ #2}{\lambda\parens{#2}}}
\NewDocumentCommand{\Ax}{}{\star}
\NewDocumentCommand{\TyLift}{m}{{\Uparrow}#1}
\NewDocumentCommand{\Uni}{}{\mathsf{U}}
\NewDocumentCommand{\Dec}{m}{\mathsf{El}(#1)}
\NewDocumentCommand{\Enc}{m}{\mathsf{Code}(#1)}
\NewDocumentCommand{\Id}{mmm}{\mathsf{Id}_{#1}(#2, #3)}
\NewDocumentCommand{\Idsym}{}{\mathsf{Id}}
\NewDocumentCommand{\Eq}{mmm}{\mathsf{Eq}_{#1}(#2, #3)}
\NewDocumentCommand{\Refl}{m}{\mathsf{refl}(#1)}
\NewDocumentCommand{\IdRec}{mmm}{\mathsf{J}(#1, #2, #3)}
\NewDocumentCommand{\MkBox}{O{\mu}m}{\mathsf{mod}_{#1}(#2)}
\NewDocumentCommand{\LetMod}{mO{\,\underline{\phantom{-}}\,}mD<>{\mu}O{\nu}}{
  \mathsf{let}_{\ifthenelse{\equal{#5}{1}}{}{#5}}\ \MkBox[#4]{#2} \gets #1\ \mathsf{in}\ #3
}
\NewDocumentCommand{\Open}{O{\mu}mo}{\mathsf{open}_{#1}(#2\IfValueT{#3}{{}; #3})}
\NewDocumentCommand{\Sb}{mm}{#1\brackets{#2}}
\NewDocumentCommand{\Emp}{}{\cdot}
\NewDocumentCommand{\ISb}{}{\mathsf{id}}
\NewDocumentCommand{\ESb}{mm}{{#1}.{#2}}
\NewDocumentCommand{\Wk}{O{}}{{\uparrow^{#1}}}
\NewDocumentCommand{\Keysymbol}{}{\scaleobj{0.85}{\text{\faKey}}}
\NewDocumentCommand{\Key}{mm}{\Keysymbol_{#2}^{#1}}
\NewDocumentCommand{\Bool}{}{\mathbb{B}}
\NewDocumentCommand{\True}{}{\mathsf{tt}}
\NewDocumentCommand{\False}{}{\mathsf{ff}}
\NewDocumentCommand{\BoolRec}{mmmm}{\mathsf{if}(#1; #2; #3; #4)}

\NewDocumentCommand{\ECx}{mmD<>{\mu}}{#1.(\DeclNameless{#2}<#3>)}
\NewDocumentCommand{\ECxV}{mmmD<>{\mu}}{#1, \DeclVar{#2}{#3}<#4>}
\NewDocumentCommand{\LockCx}{mD<>{\mu}}{#1.\Lock_{#2}}
\NewDocumentCommand{\UnlockCx}{mmD<>{\mu}}{(#1;#2).\Unlock_{#3}}
\NewDocumentCommand{\LockCxV}{mmD<>{\mu}}{#1, #2 : \Lock_{#3}}
\NewDocumentCommand{\LockSb}{mD<>{\mu}}{#1.\Lock_{#2}}
\NewDocumentCommand{\UnlockSb}{mD<>{\mu}}{#1.\Unlock_{#2}}
\NewDocumentCommand{\Locks}{m}{\mathsf{locks}(#1)}
\NewDocumentCommand{\StripCx}{m}{\vverts{#1}}
\NewDocumentCommand{\StripSb}{m}{\vverts{#1}}

\NewDocumentCommand{\Sort}{m}{#1\ \mathsf{sort}}
\NewDocumentCommand{\Lvl}{}{\mathcal{L}}
\NewDocumentCommand{\Ty}{mO{\ell}}{\mathsf{type}_{#1}^{#2}}
\NewDocumentCommand{\DTy}{mO{\ell}}{\mathsf{dtype}_{#1}^{#2}}
\NewDocumentCommand{\Tm}{m}{\mathsf{tm}_{#1}}
\NewDocumentCommand{\Cx}{m}{\mathsf{ctx}_{#1}}
\NewDocumentCommand{\Sub}{m}{\mathsf{sb}_{#1}}

\NewDocumentCommand{\IsCx}{m}{#1\ \mathsf{cx}}
\NewDocumentCommand{\IsTy}{O{\Gamma}m}{#1 \vdash #2\ \mathsf{type}}
\NewDocumentCommand{\IsTm}{O{\Gamma}mm}{#1 \vdash #2 : #3}
\NewDocumentCommand{\IsSb}{O{\Gamma}mm}{#1 \vdash #2 : #3}
\NewDocumentCommand{\EqCx}{mm}{#1 = #2\ \mathsf{cx}}
\NewDocumentCommand{\EqTy}{O{\Gamma}mm}{#1 \vdash #2 = #3\ \mathsf{type}}
\NewDocumentCommand{\EqTm}{O{\Gamma}mmm}{#1 \vdash #2 = #3 : #4}
\NewDocumentCommand{\EqSb}{O{\Gamma}mmm}{#1 \vdash #2 = #3 : #4}

\NewDocumentCommand{\CX}{}{\mathbf{Cx}}
\NewDocumentCommand{\Interp}{m}{\llbracket #1 \rrbracket}

\NewDocumentCommand{\Mode}{}{\mathcal{M}}

\NewDocumentCommand{\InterpModal}{m}{\Interp{\Lock_{#1}}}
\NewDocumentCommand{\InterpKey}{m}{\Interp{\Keysymbol^{#1}}}
\NewDocumentCommand{\InterpMode}{m}{\mathcal{C}\brackets{#1}}
\NewDocumentCommand{\SynCat}{m}{\mathbb{S}\brackets{#1}}
\NewDocumentCommand{\Mod}{mo}{\mathcal{#1}\IfValueT{#2}{[#2]}}
\NewDocumentCommand{\ModTy}{mm}{\mathcal{U}_{\mathcal{#1}[#2]}}
\NewDocumentCommand{\ModTm}{mm}{\widetilde{\mathcal{U}}_{\mathcal{#1}[#2]}}
\NewDocumentCommand{\ModEl}{mm}{\tau_{\mathcal{#1}[#2]}}

\NewDocumentCommand{\Syn}{sm}{\IfBooleanTF{#1}{\parens*{#2}}{#2}^{\scaleobj{0.90}{\lhd}}}
\NewDocumentCommand{\Sem}{sm}{\IfBooleanTF{#1}{\parens*{#2}}{#2}^{\scaleobj{0.90}{\RHD}}}
\NewDocumentCommand{\Pred}{m}{\phi_{#1}}

%% Specific modal situation macros
\NewDocumentCommand{\Later}{}{\RHD}
\NewDocumentCommand{\Earlier}{}{\LHD}
\RenewDocumentCommand{\Diamond}{}{\blacklozenge}
\NewDocumentCommand{\CComp}{}{\Pi_0}
\ifcsname Disc\endcsname%
    \RenewDocumentCommand{\Disc}{}{\Delta}%
  \else%
    \NewDocumentCommand{\Disc}{}{\Delta}%
  \fi%
\NewDocumentCommand{\GSec}{}{\Gamma}
\NewDocumentCommand{\CoDisc}{}{\nabla}
\NewDocumentCommand{\Warp}{m}{\ast_{#1}}

\NewDocumentCommand{\Lob}{}{\textnormal{l{\"o}b}}
\NewDocumentCommand{\LobV}{mm}{\textnormal{l{\"o}b}(#1.\ #2)}
\NewDocumentCommand{\Always}{}{\mathsf{box}}
\NewDocumentCommand{\Poss}{}{\mathsf{dia}}
\RenewDocumentCommand{\Join}{}{\mathsf{join}}
\NewDocumentCommand{\Dup}{}{\mathsf{dup}}
\NewDocumentCommand{\Unbox}{}{\mathsf{extract}}
\NewDocumentCommand{\Force}{}{\mathsf{now}}
\NewDocumentCommand{\Contract}{}{\mathsf{contract}}
\NewDocumentCommand{\Next}{}{\mathsf{next}}
\NewDocumentCommand{\RawStr}{}{\mathsf{GStr}}
\NewDocumentCommand{\Str}{}{\mathsf{Str}}
\NewDocumentCommand{\Cons}{}{\mathsf{cons}}
\NewDocumentCommand{\Uncons}{}{\mathsf{uncons}}
\NewDocumentCommand{\Head}{}{\mathsf{head}}
\NewDocumentCommand{\Tail}{}{\mathsf{tail}}
\NewDocumentCommand{\ZipWith}{}{\mathsf{zipWith}}
\NewDocumentCommand{\ZipWithHelper}{}{\mathsf{go}}

%% Modal operations
\NewDocumentCommand{\Coe}{mmmg}{\mathbf{coe}\brackets{\IfValueT{#4}{#4 :{}} #2 \IfValueTF{#4}{\To}{\le} #3}\ifthenelse{\equal{#1}{}}{}{(#1)}}
\NewDocumentCommand{\MComp}{smmm}{\mathbf{comp}_{#3,#4}^{\IfBooleanTF{#1}{\text{-1}}{}}\ifthenelse{\equal{#2}{}}{}{(#2)}}
\NewDocumentCommand{\Triv}{sm}{\mathbf{triv}^{\IfBooleanTF{#1}{\text{-1}}{}}(#2)}
\NewDocumentCommand{\TrivT}{s}{\mathbf{triv}^{\IfBooleanTF{#1}{\text{-1}}{}}}
\NewDocumentCommand{\ZApp}{mmm}{#1 \mathbin{\circledast_{#3}} #2}

\NewDocumentCommand{\PRACAT}{}{\CAT_{\mathsf{pra}}}
\NewDocumentCommand{\EPRACAT}{}{\CAT_{\mathsf{cc},\mathsf{epra}}}

\NewDocumentCommand{\RAdj}{mg}{\widebar{#1}\IfValueT{#2}{(#2)}}
\NewDocumentCommand{\LAdj}{mg}{\wideunderbar{#1}\IfValueT{#2}{(#2)}}
